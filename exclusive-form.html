<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title data-es="Representación Exclusiva – Propiedades Altura" data-en="Exclusive Representation – Propiedades Altura">
    Representación Exclusiva – Propiedades Altura
  </title>
  <meta name="description" content="Contrato de representación exclusiva – Comisión 3% sólo al vender">

  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="sell.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&display=swap" rel="stylesheet">

  <style>
    /* small helper styles for steps — won't conflict much with your CSS */
    .center { text-align:center; }
    .card { display:inline-block; background:#000;color:#FFD700;border-radius:18px;padding:3.2rem 3.8rem;border:6px solid #FFD700; box-shadow:0 35px 60px rgba(0,0,0,0.25); cursor:pointer; }
    .step { display:none; margin-top:2.5rem; }
    .step.active { display:block; animation:fadeIn .28s ease; }
    @keyframes fadeIn { from {opacity:0; transform:translateY(6px)} to {opacity:1; transform:translateY(0)} }
    .small-row { display:flex; gap:1rem; flex-wrap:wrap; align-items:center; }
    .small-row > * { flex:1 1 220px; }
    .inline-note { font-size:.95rem; color:#444 }
    .muted { color:#666; font-size:0.98rem }
    .btn { background:#000;color:#FFD700;padding:.9rem 1.4rem;border-radius:12px;border:3px solid #FFD700;font-weight:700; cursor:pointer }
    .btn.ghost { background:transparent;color:#000;border-color:#ddd }
    .photo-upload { border:2px dashed rgba(0,0,0,0.08); padding:1rem; border-radius:12px; text-align:center; cursor:pointer; }
    .photo-preview img { width:120px; height:80px; object-fit:cover; border-radius:8px; margin:6px; }
    .hidden { display:none !important; }
    @media (max-width:640px){ .card{padding:2rem 2.4rem} }
  </style>
</head>
<body>
  <div class="page">

    <!-- HEADER -->
    <header class="site-header" role="banner">
      <div class="wrap header-inner">
        <a class="logo" href="index.html">
          <svg class="logo-icon" viewBox="0 0 64 64"><path d="M4 56 L32 8 L60 56 Z" fill="currentColor"/></svg>
          <span class="brand" data-es="Propiedades Altura" data-en="Propiedades Altura">Propiedades Altura</span>
        </a>

        <nav class="header-nav">
          <div class="lang" id="lang-switch">
            <button class="lang-btn" data-lang="es" aria-pressed="true">ES</button>
            <button class="lang-btn" data-lang="en" aria-pressed="false">EN</button>
          </div>
          <a class="cta mobile-main-cta" href="index.html#properties" data-es="Ver Propiedades" data-en="View Properties">Ver Propiedades</a>
        </nav>
      </div>

      <p class="tagline" data-es="ORIENTE ANTIOQUEÑO" data-en="EASTERN ANTIOQUIA">ORIENTE ANTIOQUEÑO</p>
    </header>

    <main style="max-width:960px;margin:3.5rem auto 6rem;padding:0 1rem;text-align:center;">
      <!-- STEP 1: Card -->
      <h1 data-es="Vende tu propiedad" data-en="Sell Your Property">Vende tu propiedad</h1>
      <p class="muted" data-es="Selecciona cómo quieres publicar tu propiedad" data-en="Choose how you want to list your property">Selecciona cómo quieres publicar tu propiedad</p>

      <div style="margin:3.5rem 0;">
        <div id="exclusive-card" class="card" role="button" tabindex="0" aria-pressed="false">
          <div style="font-size:2.4rem;line-height:1.05;" data-es="Representación<br>Exclusiva" data-en="Exclusive<br>Representation">Representación<br>Exclusiva</div>
          <div style="font-size:1rem;margin-top:1rem;" data-es="Comisión 3% al vender · Gratis" data-en="3% commission on sale · Free">Comisión 3% al vender · Gratis</div>
        </div>
      </div>

      <!-- STEP 2: Short pre-questions -->
      <section id="step-2" class="step" aria-hidden="true">
        <h2 data-es="Antes de continuar" data-en="Before you continue">Antes de continuar</h2>
        <p class="muted" data-es="Contesta estas preguntas rápidas para ayudarnos a calificar tu propiedad." data-en="Answer these quick questions to help us qualify your property.">Contesta estas preguntas rápidas para ayudarnos a calificar tu propiedad.</p>

        <form id="pre-questions" class="form-grid" onsubmit="return false;" style="margin-top:1.5rem;text-align:left;max-width:760px;margin-left:auto;margin-right:auto;">
          <div>
            <label data-es="Tipo de propiedad" data-en="Property type">Tipo de propiedad</label>
            <select name="pre_property_type" id="pre_property_type" required>
              <option value="" data-es="Selecciona..." data-en="Select...">Selecciona...</option>
              <option value="Casa" data-es="Casa" data-en="House">Casa</option>
              <option value="Apartamento" data-es="Apartamento" data-en="Apartment">Apartamento</option>
              <option value="Finca" data-es="Finca" data-en="Farm">Finca</option>
              <option value="Lote" data-es="Lote" data-en="Lot">Lote</option>
              <option value="Local comercial" data-es="Local comercial" data-en="Commercial space">Local comercial</option>
            </select>
          </div>

          <div>
            <label data-es="Rango de precio" data-en="Price range">Rango de precio</label>
            <select name="pre_price_range" id="pre_price_range" required>
              <option value="" data-es="Selecciona..." data-en="Select...">Selecciona...</option>
              <option value="0-100M" data-es="0 - 100.000.000 COP" data-en="0 - 100,000,000 COP">0 - 100.000.000 COP</option>
              <option value="100-300M" data-es="100.000.000 - 300.000.000 COP" data-en="100,000,000 - 300,000,000 COP">100.000.000 - 300.000.000 COP</option>
              <option value="300-600M" data-es="300.000.000 - 600.000.000 COP" data-en="300,000,000 - 600,000,000 COP">300.000.000 - 600.000.000 COP</option>
              <option value="600M+" data-es="Más de 600.000.000 COP" data-en="More than 600,000,000 COP">Más de 600.000.000 COP</option>
            </select>
          </div>

          <div>
            <label data-es="¿La propiedad está lista para vender?" data-en="Is the property ready to sell?">¿La propiedad está lista para vender?</label>
            <select id="pre_ready" required>
              <option value="" data-es="Selecciona..." data-en="Select...">Selecciona...</option>
              <option value="si" data-es="Sí" data-en="Yes">Sí</option>
              <option value="no" data-es="No" data-en="No">No</option>
            </select>
          </div>

          <div>
            <label data-es="Ciudad / Municipio" data-en="City / Municipality">Ciudad / Municipio</label>
            <input type="text" id="pre_city" placeholder="Guarne, Rionegro..." required>
          </div>

          <div>
            <label data-es="Método de contacto preferido" data-en="Preferred contact method">Método de contacto preferido</label>
            <select id="pre_contact" required>
              <option value="" data-es="Selecciona..." data-en="Select...">Selecciona...</option>
              <option value="whatsapp" data-es="WhatsApp" data-en="WhatsApp">WhatsApp</option>
              <option value="telefono" data-es="Teléfono" data-en="Phone">Teléfono</option>
              <option value="email" data-es="Email" data-en="Email">Email</option>
            </select>
          </div>

          <div style="text-align:center;margin-top:1.4rem;">
            <button id="pre-continue" class="btn" type="button" disabled data-es="Continuar" data-en="Continue">Continuar</button>
            <div style="margin-top:.5rem" class="inline-note" data-es="Necesitamos estas respuestas antes de continuar." data-en="We need these answers before continuing.">Necesitamos estas respuestas antes de continuar.</div>
          </div>
        </form>
      </section>

      <!-- STEP 3: Acceptance checkbox -->
      <section id="step-3" class="step" aria-hidden="true">
        <h2 data-es="Contrato de Representación" data-en="Representation Agreement">Contrato de Representación</h2>
        <div style="max-width:900px;margin:0 auto;text-align:left;">
          <div class="contract-box" style="text-align:left;">
            <p data-es="Por medio del presente contrato, el propietario autoriza en forma exclusiva a Propiedades Altura para la intermediación en la venta de su inmueble durante un período de 6 meses contados a partir de la aceptación electrónica."
               data-en="By this agreement, the owner grants Propiedades Altura exclusive authority to mediate the sale of the property for 6 months starting from electronic acceptance.">
              Por medio del presente contrato, el propietario autoriza en forma exclusiva a Propiedades Altura para la intermediación en la venta de su inmueble durante un período de 6 meses contados a partir de la aceptación electrónica.
            </p>
            <p data-es="La comisión pactada será del 3% + IVA sobre el valor final de venta, pagadera únicamente cuando la operación se concrete con éxito."
               data-en="The agreed commission will be 3% + VAT on the final sale price, payable only when the transaction is completed successfully.">
              La comisión pactada será del 3% + IVA sobre el valor final de venta, pagadera únicamente cuando la operación se concrete con éxito.
            </p>
            <p style="margin-top:.6rem;" class="muted" data-es="Marca la casilla para aceptar el contrato y continuar con el formulario completo." data-en="Check the box to accept the agreement and continue to the full form.">
              Marca la casilla para aceptar el contrato y continuar con el formulario completo.
            </p>
          </div>

          <div style="text-align:center;margin-top:1.4rem;">
            <label style="cursor:pointer;font-size:1.1rem;">
              <input type="checkbox" id="accept-checkbox">
              <span style="margin-left:.6rem" data-es="He leído y acepto el contrato de representación exclusiva (6 meses, comisión 3%)."
                                            data-en="I have read and accept the exclusive representation agreement (6 months, 3% commission).">
                He leído y acepto el contrato de representación exclusiva (6 meses, comisión 3%).
              </span>
            </label>
          </div>
        </div>

        <div style="text-align:center;margin-top:1.2rem;">
          <button id="accept-continue" class="btn" type="button" disabled data-es="Completar formulario" data-en="Complete form">Completar formulario</button>
        </div>
      </section>

      <!-- STEP 4: Full form (hidden until acceptance) -->
      <section id="step-4" class="step" aria-hidden="true">
        <h2 data-es="Completar datos de la propiedad" data-en="Complete property details">Completar datos de la propiedad</h2>

        <form id="full-form" class="form-grid" name="exclusive" method="POST" data-netlify="true" netlify-honeypot="bot-field" enctype="multipart/form-data" style="max-width:920px;margin:0 auto;text-align:left;">

          <input type="hidden" name="listing_type" value="exclusive">

          <!-- Contact -->
          <div><label data-es="Nombre completo *" data-en="Full name *">Nombre completo *</label>
            <input type="text" name="name" required placeholder="John Doe"></div>

          <div><label data-es="Email *" data-en="Email *">Email *</label>
            <input type="email" name="_replyto" required placeholder="john@example.com"></div>

          <div><label data-es="Teléfono / WhatsApp *" data-en="Phone / WhatsApp *">Teléfono / WhatsApp *</label>
            <input type="tel" name="phone" required placeholder="+57 300 123 4567"></div>

          <!-- Property quicks (pre-filled from Step 2 where possible) -->
          <div>
            <label data-es="Tipo de propiedad" data-en="Property type">Tipo de propiedad</label>
            <select name="property_type" id="full_property_type">
              <option value="" data-es="Selecciona..." data-en="Select...">Selecciona...</option>
              <option value="Casa" data-es="Casa" data-en="House">Casa</option>
              <option value="Apartamento" data-es="Apartamento" data-en="Apartment">Apartamento</option>
              <option value="Finca" data-es="Finca" data-en="Farm">Finca</option>
              <option value="Lote" data-es="Lote" data-en="Lot">Lote</option>
              <option value="Local comercial" data-es="Local comercial" data-en="Commercial space">Local comercial</option>
            </select>
          </div>

          <div><label data-es="Área construida (m²) *" data-en="Built area (m²) *">Área construida (m²) *</label>
            <input type="number" name="area_m2" required placeholder="250"></div>

          <div><label data-es="Área lote (m²) *" data-en="Lot area (m²) *">Área lote (m²) *</label>
            <input type="number" name="lot_size" required placeholder="1000"></div>

          <div><label data-es="Habitaciones *" data-en="Bedrooms *">Habitaciones *</label>
            <input type="number" name="bedrooms" required placeholder="3"></div>

          <div><label data-es="Baños *" data-en="Bathrooms *">Baños *</label>
            <input type="number" name="bathrooms" required placeholder="2"></div>

          <div><label data-es="Parqueaderos *" data-en="Garage / Parking *">Parqueaderos *</label>
            <input type="number" name="parking" required placeholder="2"></div>

          <div><label data-es="Número de cuartos (rooms) *" data-en="Number of rooms *">Número de cuartos (rooms) *</label>
            <input type="number" name="rooms" required placeholder="5"></div>

          <div><label data-es="Precio esperado" data-en="Expected sale price">Precio esperado</label>
            <input type="number" name="asking_price" placeholder="500000000"></div>

          <!-- Owner financing -->
          <div class="full-width" style="margin:1.2rem 0;">
            <label style="display:flex;align-items:flex-start;cursor:pointer;">
              <input type="checkbox" name="open_to_financing" id="open_to_financing" style="width:24px;height:24px;margin-right:12px;">
              <span data-es="Estoy abierto a considerar financiación directa con el comprador" data-en="I am open to considering direct owner financing with the buyer">
                Estoy abierto a considerar financiación directa con el comprador
              </span>
            </label>

            <div id="financing-terms" style="display:none;margin-top:.8rem;">
              <label data-es="Condiciones de financiación (plazo, cuota inicial, tasa) " data-en="Financing terms (term, down payment, rate)">
                Condiciones de financiación (plazo, cuota inicial, tasa)
              </label>
              <input type="text" name="financing_terms" placeholder="Ej. 60 meses, 20% inicial, tasa fija...">
            </div>
          </div>

          <!-- Additional professional questions (optional) -->
          <h3 style="margin-top:1.6rem;" data-es="Detalle adicional de la propiedad" data-en="Additional property details">Detalle adicional de la propiedad</h3>

          <div>
            <label data-es="Año de construcción" data-en="Year built">Año de construcción</label>
            <input type="number" name="year_built" placeholder="2010">
          </div>

          <div>
            <label data-es="Estrato" data-en="Socioeconomic level">Estrato</label>
            <input type="number" name="estrato" placeholder="4">
          </div>

          <div>
            <label data-es="Estado general de la propiedad" data-en="General condition of the property">Estado general de la propiedad</label>
            <select name="condition">
              <option value="" data-es="Selecciona..." data-en="Select...">Selecciona...</option>
              <option value="Excelente" data-es="Excelente" data-en="Excellent">Excelente</option>
              <option value="Bueno" data-es="Bueno" data-en="Good">Bueno</option>
              <option value="Requiere mejoras" data-es="Requiere mejoras" data-en="Needs improvements">Requiere mejoras</option>
            </select>
          </div>

          <div>
            <label data-es="¿La propiedad está amoblada?" data-en="Is the property furnished?">¿La propiedad está amoblada?</label>
            <select name="furnished">
              <option value="" data-es="Selecciona..." data-en="Select...">Selecciona...</option>
              <option value="si" data-es="Sí" data-en="Yes">Sí</option>
              <option value="no" data-es="No" data-en="No">No</option>
            </select>
          </div>

          <div>
            <label data-es="¿Tiene administración / HOA?" data-en="Has HOA / admin fees?">¿Tiene administración / HOA?</label>
            <select name="hoa">
              <option value="" data-es="Selecciona..." data-en="Select...">Selecciona...</option>
              <option value="si" data-es="Sí" data-en="Yes">Sí</option>
              <option value="no" data-es="No" data-en="No">No</option>
            </select>
          </div>

          <div>
            <label data-es="Valor administración (si aplica)" data-en="HOA fee (if applies)">Valor administración (si aplica)</label>
            <input type="text" name="hoa_amount" placeholder="Ej. $120.000">
          </div>

          <div>
            <label data-es="¿Hay inquilinos?" data-en="Is there a tenant?">¿Hay inquilinos?</label>
            <select name="tenant_present">
              <option value="" data-es="Selecciona..." data-en="Select...">Selecciona...</option>
              <option value="si" data-es="Sí" data-en="Yes">Sí</option>
              <option value="no" data-es="No" data-en="No">No</option>
            </select>
          </div>

          <div>
            <label data-es="Fecha disponible para entrega" data-en="Available move-out date">Fecha disponible para entrega</label>
            <input type="date" name="available_date">
          </div>

          <!-- Map picker -->
          <div class="full-width" style="margin-top:1rem;">
            <label data-es="Haz clic en el mapa para seleccionar ubicación exacta" data-en="Click on the map to select exact location">Haz clic en el mapa para seleccionar ubicación exacta</label>
            <div id="map" style="height:420px;margin:1rem 0;border-radius:12px;"></div>
            <input type="hidden" name="latitude" id="lat">
            <input type="hidden" name="longitude" id="lng">
            <input type="hidden" name="google_maps_link" id="maps-link">
            <div><small id="coords" style="color:#1d4ed8;font-weight:600;"></small><br>
            <a id="open-map" href="#" target="_blank" style="display:none;color:#1d4ed8;">→ Abrir en Google Maps</a></div>
          </div>

          <!-- Photos -->
          <div class="full-width" style="margin-top:1rem;">
            <label data-es="Sube fotos de tu propiedad (máx. 10)" data-en="Upload photos of your property (max 10)">Sube fotos de tu propiedad (máx. 10)</label>
            <div class="photo-upload" id="photoDrop">
              <input type="file" name="photos" id="photos" accept="image/*" multiple style="display:none;">
              <p><strong data-es="Clic o arrastra aquí" data-en="Click or drag here">Clic o arrastra aquí</strong><br><small data-es="Máximo 10 fotos" data-en="Up to 10 photos">Máximo 10 fotos</small></p>
              <div class="photo-preview" id="preview"></div>
            </div>
          </div>

          <!-- Additional message -->
          <div class="full-width" style="margin-top:1rem;">
            <label data-es="Mensaje adicional" data-en="Additional message">Mensaje adicional</label>
            <textarea name="message" placeholder="Urgencia, condiciones especiales..."></textarea>
          </div>

          <!-- Submit -->
          <div class="full-width" style="margin-top:1.6rem;text-align:center;">
            <button type="submit" class="btn" style="padding:1.2rem 2.2rem;font-size:1.05rem;" data-es="Enviar Solicitud de Representación Exclusiva" data-en="Send Exclusive Representation Request">
              Enviar Solicitud de Representación Exclusiva
            </button>
          </div>

        </form>
      </section>

    </main>
  </div>

  <!-- SCRIPTS -->
  <script>
    // Language application function (literal English)
    function applyLanguage(lang) {
      document.documentElement.lang = lang;
      document.querySelectorAll('[data-es]').forEach(el => {
        const key = 'data-' + lang;
        const text = el.getAttribute(key);
        if (!text) return;
        // For inputs with placeholder attributes we won't override inner HTML
        if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA' || el.tagName === 'SELECT') {
          // if select/option/label etc: set textContent where appropriate
          if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
            // do nothing for inputs without data attributes (placeholders left as-is)
            if (el.hasAttribute('data-placeholder-' + lang)) {
              el.placeholder = el.getAttribute('data-placeholder-' + lang) || '';
            }
            return;
          }
        }
        // update text for elements
        if (el.children.length === 0) {
          el.textContent = text;
        } else {
          // try to replace first text node to avoid removing nested tags
          const first = el.firstChild;
          if (first && first.nodeType === Node.TEXT_NODE) first.nodeValue = text;
          else el.textContent = text;
        }
      });

      // update options placeholders separately
      document.querySelectorAll('option[data-es]').forEach(opt => {
        const text = opt.getAttribute('data-' + lang);
        if (text) opt.textContent = text;
      });
    }

    // language buttons
    document.querySelectorAll('.lang-btn').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const lang = btn.dataset.lang;
        applyLanguage(lang);
        document.querySelectorAll('.lang-btn').forEach(b=> b.setAttribute('aria-pressed', b.dataset.lang===lang));
      });
    });

    // initialize to Spanish by default
    (function(){ applyLanguage('es'); })();


    /* ---------- Step flow logic ---------- */
    const card = document.getElementById('exclusive-card');
    const step2 = document.getElementById('step-2');
    const preForm = document.getElementById('pre-questions');
    const preContinue = document.getElementById('pre-continue');

    const step3 = document.getElementById('step-3');
    const acceptCheckbox = document.getElementById('accept-checkbox');
    const acceptContinue = document.getElementById('accept-continue');

    const step4 = document.getElementById('step-4');

    // click card -> reveal step 2
    card.addEventListener('click', ()=> {
      step2.classList.add('active'); step2.setAttribute('aria-hidden','false');
      card.setAttribute('aria-pressed','true');
      step2.scrollIntoView({behavior:'smooth'});
    });
    card.addEventListener('keypress', (e)=> { if (e.key === 'Enter' || e.key === ' ') card.click(); });

    // enable 'Continuar' when all pre-questions filled
    function checkPreQuestions() {
      const type = document.getElementById('pre_property_type').value;
      const price = document.getElementById('pre_price_range').value;
      const ready = document.getElementById('pre_ready').value;
      const city = document.getElementById('pre_city').value.trim();
      const contact = document.getElementById('pre_contact').value;
      preContinue.disabled = !(type && price && ready && city && contact);
    }
    ['change','input'].forEach(ev => {
      document.getElementById('pre_property_type').addEventListener(ev, checkPreQuestions);
      document.getElementById('pre_price_range').addEventListener(ev, checkPreQuestions);
      document.getElementById('pre_ready').addEventListener(ev, checkPreQuestions);
      document.getElementById('pre_city').addEventListener(ev, checkPreQuestions);
      document.getElementById('pre_contact').addEventListener(ev, checkPreQuestions);
    });

    preContinue.addEventListener('click', ()=> {
      // show step 3
      step3.classList.add('active'); step3.setAttribute('aria-hidden','false');
      step3.scrollIntoView({behavior:'smooth'});
      // optionally copy pre-answers into full form
      const fullType = document.getElementById('full_property_type');
      fullType.value = document.getElementById('pre_property_type').value || '';
    });

    // enable acceptContinue only when checkbox checked
    acceptCheckbox.addEventListener('change', ()=> {
      acceptContinue.disabled = !acceptCheckbox.checked;
    });

    acceptContinue.addEventListener('click', ()=> {
      // reveal full form only if accepted
      if (!acceptCheckbox.checked) return;
      step4.classList.add('active'); step4.setAttribute('aria-hidden','false');
      step4.scrollIntoView({behavior:'smooth'});
    });


    /* ---------- Photo upload (drag & drop) ---------- */
    (function(){
      const input = document.getElementById('photos');
      const drop = document.getElementById('photoDrop');
      const preview = document.getElementById('preview');
      const MAX = 10;

      drop.addEventListener('click', ()=> input.click());
      drop.addEventListener('dragover', e=> { e.preventDefault(); drop.style.opacity=.9; });
      drop.addEventListener('dragleave', e=> { e.preventDefault(); drop.style.opacity=1; });
      drop.addEventListener('drop', e=> {
        e.preventDefault(); drop.style.opacity=1;
        if (e.dataTransfer && e.dataTransfer.files) {
          input.files = e.dataTransfer.files;
          updatePreview(input.files);
        }
      });

      input.addEventListener('change', ()=> updatePreview(input.files));

      function updatePreview(files) {
        preview.innerHTML = '';
        Array.from(files).slice(0,MAX).forEach(file=>{
          if (!file.type.startsWith('image/')) return;
          const img = document.createElement('img');
          img.alt = file.name;
          img.src = URL.createObjectURL(file);
          preview.appendChild(img);
        });
        if (files.length > MAX) preview.innerHTML += `<small style="color:red;">Solo las primeras ${MAX} fotos se enviarán.</small>`;
      }
    })();


    /* ---------- Map picker ---------- */
    function initSellMap() {
      try {
        const latInput = document.getElementById('lat');
        const lngInput = document.getElementById('lng');
        const linkInput = document.getElementById('maps-link');
        const coordsEl = document.getElementById('coords');
        const openMap = document.getElementById('open-map');
        const mapEl = document.getElementById('map');

        const defaultCenter = { lat: 6.1935, lng: -75.3832 };
        const map = new google.maps.Map(mapEl, { center: defaultCenter, zoom: 11, streetViewControl:false, mapTypeControl:false });

        let marker = null;
        map.addListener('click', (e)=> {
          const pos = e.latLng;
          if (marker) marker.setPosition(pos);
          else marker = new google.maps.Marker({ position: pos, map });
          const lat = pos.lat().toFixed(6);
          const lng = pos.lng().toFixed(6);
          latInput.value = lat; lngInput.value = lng;
          linkInput.value = `https://www.google.com/maps?q=${lat},${lng}&z=18`;
          coordsEl.textContent = `Guardado: ${parseFloat(lat).toFixed(5)}, ${parseFloat(lng).toFixed(5)}`;
          openMap.href = linkInput.value;
          openMap.style.display = 'inline';
        });

        // restore marker if inputs have values (in case of back-navigation)
        if (latInput.value && lngInput.value) {
          const p = { lat: parseFloat(latInput.value), lng: parseFloat(lngInput.value) };
          marker = new google.maps.Marker({ position: p, map });
          map.setCenter(p);
          map.setZoom(15);
        }
      } catch(e) {
        console.error('initSellMap error', e);
      }
    }
    window.initSellMap = initSellMap;

    /* ---------- Financing toggle show/hide terms ---------- */
    document.getElementById('open_to_financing').addEventListener('change', function(){
      const block = document.getElementById('financing-terms');
      block.style.display = this.checked ? 'block' : 'none';
    });

    /* ---------- Ensure required fields presence (rooms, garage, bedrooms, bathrooms, area, lot) enforced by HTML required attribute ---------- */

  </script>

  <!-- GOOGLE MAPS -->
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCoIGK7pUUxiu0nJSJ79ckIcayGm5O31Zo&callback=initSellMap"></script>
</body>
</html>
